{
  "hash": "6bcba21d4eb4e2c5bd460d6513399f0f",
  "result": {
    "markdown": "---\ntitle: \"Randomized Controlled Trials\"\n---\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-1_6681e6b58d8061565b60c6490a3a8e2f'}\n\n```{.r .cell-code}\n#1\n\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'dplyr' was built under R version 4.3.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:stats':\n#> \n#>     filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:base':\n#> \n#>     intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: package 'ggplot2' was built under R version 4.3.2\n```\n:::\n\n```{.r .cell-code}\ndata <- readRDS(\"C:/Users/Anjali/Downloads/Causal_Data_Science_Data (1)/Causal_Data_Science_Data/abtest_online.rds\")\n\ntreatment_data <- subset(data, chatbot == 1)\ncontrol_data <- subset(data, chatbot == 0)\n\n# Convert 'previous_visits' to numeric if it's not already\ndata <- data %>%\n  mutate(previous_visits = as.numeric(previous_visit))\n\n# Visualize covariate distributions\n# Using ggplot2 for a more flexible and customizable approach\nggplot(data, aes(x = previous_visit)) +\n  geom_histogram(binwidth = 1, fill = \"lightblue\", color = \"black\") +\n  facet_wrap(~ chatbot, scales = \"free\") +\n  labs(title = \"Distribution of Previous Visits by Group\", x = \"Previous Visits\")\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Similar plot for 'mobile_device' as a bar plot\nggplot(data, aes(x = factor(mobile_device), fill = factor(mobile_device))) +\n  geom_bar() +\n  facet_wrap(~ chatbot) +\n  labs(title = \"Distribution of Mobile Device by Group\", x = \"Mobile Device\", y = \"Count\")\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n:::\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-2_7310d330afb4b27a84100a18c3aacb8f'}\n\n```{.r .cell-code}\n#2\nmodel <- lm(purchase_amount ~ chatbot, data = data)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot, data = data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -16.702 -14.478  -9.626  13.922  64.648 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  16.7017     0.8374  19.944  < 2e-16 ***\n#> chatbotTRUE  -7.0756     1.1796  -5.998 2.79e-09 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.65 on 998 degrees of freedom\n#> Multiple R-squared:  0.0348,\tAdjusted R-squared:  0.03383 \n#> F-statistic: 35.98 on 1 and 998 DF,  p-value: 2.787e-09\n```\n:::\n:::\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-3_4cb07599063c1239e3f5f88396cb7932'}\n\n```{.r .cell-code}\n#3\n\nmodel_interaction <- lm(purchase_amount ~ chatbot * mobile_device, data = data)\n\n\n# Print the summary of the interaction model\nsummary(model_interaction)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot * mobile_device, data = data)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#> -16.98 -14.54  -9.95  14.13  65.24 \n#> \n#> Coefficients:\n#>                               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                    16.9797     1.0152  16.725   <2e-16 ***\n#> chatbotTRUE                    -7.0301     1.4284  -4.922    1e-06 ***\n#> mobile_deviceTRUE              -0.8727     1.7987  -0.485    0.628    \n#> chatbotTRUE:mobile_deviceTRUE  -0.1526     2.5369  -0.060    0.952    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.66 on 996 degrees of freedom\n#> Multiple R-squared:  0.03534,\tAdjusted R-squared:  0.03244 \n#> F-statistic: 12.16 on 3 and 996 DF,  p-value: 8.034e-08\n```\n:::\n\n```{.r .cell-code}\n# Extract coefficients\ncoef_interaction <- coef(model_interaction)\n\nprint(coef_interaction)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>                   (Intercept)                   chatbotTRUE \n#>                    16.9796632                    -7.0301039 \n#>             mobile_deviceTRUE chatbotTRUE:mobile_deviceTRUE \n#>                    -0.8726539                    -0.1525592\n```\n:::\n\n```{.r .cell-code}\n# CATE for mobile users\nCATE_mobile <- coef_interaction[\"chatbotTRUE\"] + coef_interaction[\"chatbotTRUE:mobile_deviceTRUE\"]\n\n# Print the CATE for mobile users\ncat(\"CATE for Mobile Users:\", CATE_mobile, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> CATE for Mobile Users: -7.182663\n```\n:::\n:::\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-4_4d4b5ce459dd1eb5ef12701fb9f7d274'}\n\n```{.r .cell-code}\n#4\nlogistic_model <- glm(purchase ~ chatbot, family = binomial(link = 'logit'), data = data)\nsummary(logistic_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> glm(formula = purchase ~ chatbot, family = binomial(link = \"logit\"), \n#>     data = data)\n#> \n#> Coefficients:\n#>             Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept) -0.01613    0.08981  -0.180    0.857    \n#> chatbotTRUE -0.98939    0.13484  -7.337 2.18e-13 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 1329.1  on 999  degrees of freedom\n#> Residual deviance: 1273.3  on 998  degrees of freedom\n#> AIC: 1277.3\n#> \n#> Number of Fisher Scoring iterations: 4\n```\n:::\n\n```{.r .cell-code}\n# Extract the coefficient for chatbot\ncoef_chatbot <- coef(logistic_model)[\"chatbotTRUE\"]\n\nodds_ratio_chatbot <- exp(coef_chatbot)\n\n# Print the results\ncat(\"Odds Ratio for Chatbot:\", odds_ratio_chatbot, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Odds Ratio for Chatbot: 0.3718025\n```\n:::\n\n```{.r .cell-code}\ncat(\"Coefficient for chatbot:\", coef_chatbot, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Coefficient for chatbot: -0.9893925\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}