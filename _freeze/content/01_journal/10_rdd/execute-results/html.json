{
  "hash": "15bf7e226d68b8ea2debd43eab43c93a",
  "result": {
    "markdown": "---\ntitle: \"Regression Discontinuity\"\n---\n\n::: {.cell hash='10_rdd_cache/html/unnamed-chunk-1_0036cb7bb65803d00ecf65ab0730d937'}\n\n```{.r .cell-code}\n#1st part\n\ndata <- readRDS(\"C:/Users/Anjali/Downloads/Causal_Data_Science_Data (1)/Causal_Data_Science_Data/coupon.rds\")\n\n# Define cut-off\nc0 <- 60\n\nlibrary(rddensity)\nrddd <- rddensity(data$days_since_last, c = c0)\nsummary(rddd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Manipulation testing using local polynomial density estimation.\n#> \n#> Number of obs =       5000\n#> Model =               unrestricted\n#> Kernel =              triangular\n#> BW method =           estimated\n#> VCE method =          jackknife\n#> \n#> c = 60                Left of c           Right of c          \n#> Number of obs         3854                1146                \n#> Eff. Number of obs    1486                734                 \n#> Order est. (p)        2                   2                   \n#> Order bias (q)        3                   3                   \n#> BW est. (h)           31.203              31.915              \n#> \n#> Method                T                   P > |T|             \n#> Robust                1.1559              0.2477\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in summary.CJMrddensity(rddd): There are repeated observations. Point\n#> estimates and standard errors have been adjusted. Use option massPoints=FALSE\n#> to suppress this feature.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> P-values of binomial tests (H0: p=0.5).\n#> \n#> Window Length / 2          <c     >=c    P>|T|\n#> 0.500                      20      20    1.0000\n#> 1.000                      31      35    0.7122\n#> 1.500                      44      47    0.8341\n#> 2.000                      70      68    0.9322\n#> 2.500                      92      89    0.8819\n#> 3.000                     110     105    0.7851\n#> 3.500                     123     118    0.7967\n#> 4.000                     135     129    0.7584\n#> 4.500                     148     142    0.7691\n#> 5.000                     164     159    0.8239\n```\n:::\n:::\n\n::: {.cell hash='10_rdd_cache/html/unnamed-chunk-2_d40037a5f828211a6348dfd2f6ea377a'}\n\n```{.r .cell-code}\n# Specify your outcome variable (dependent variable)\noutcome_var <- \"purchase_after\"\n\n# Specify your running variable (the variable used for the RDD)\nrunning_var <- \"days_since_last\"\n\n# Specify the bandwidth\nbandwidth_original <- 5  # Adjust this value based on your initial analysis\n\nlm_bw <- lm(purchase_after ~ days_since_last, data)\nsummary(lm_bw)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_after ~ days_since_last, data = data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -14.244  -3.620  -0.558   2.868  34.353 \n#> \n#> Coefficients:\n#>                  Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)     12.353269   0.117865  104.81   <2e-16 ***\n#> days_since_last  0.053425   0.002281   23.42   <2e-16 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 5.331 on 4998 degrees of freedom\n#> Multiple R-squared:  0.09889,\tAdjusted R-squared:  0.09871 \n#> F-statistic: 548.5 on 1 and 4998 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nrddd <- rddensity(data$purchase_after, h = bandwidth_original)\n\n# Print the results\nsummary(rddd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Manipulation testing using local polynomial density estimation.\n#> \n#> Number of obs =       5000\n#> Model =               unrestricted\n#> Kernel =              triangular\n#> BW method =           mannual\n#> VCE method =          jackknife\n#> \n#> c = 0                 Left of c           Right of c          \n#> Number of obs         1                   4999                \n#> Eff. Number of obs    1                   66                  \n#> Order est. (p)        2                   2                   \n#> Order bias (q)        3                   3                   \n#> BW est. (h)           5                   5                   \n#> \n#> Method                T                   P > |T|             \n#> Robust                NA                  NA\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in summary.CJMrddensity(rddd): Bandwidth hl greater than the range of\n#> the data.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in summary.CJMrddensity(rddd): Bandwidth h may be too small.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> P-values of binomial tests (H0: p=0.5).\n#> \n#> Window Length / 2          <c     >=c    P>|T|\n#> 3.519                       1      20    0.0000\n#> 3.684                       1      22    0.0000\n#> 3.848                       1      23    0.0000\n#> 4.013                       1      29    0.0000\n#> 4.177                       1      36    0.0000\n#> 4.342                       1      42    0.0000\n#> 4.506                       1      49    0.0000\n#> 4.671                       1      54    0.0000\n#> 4.835                       1      59    0.0000\n#> 5.000                       1      66    0.0000\n```\n:::\n\n```{.r .cell-code}\n# half the bandwidth\nhalf_bandwidth_result <- rddensity(data$purchase_after, h = bandwidth_original/2)\nsummary(half_bandwidth_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Manipulation testing using local polynomial density estimation.\n#> \n#> Number of obs =       5000\n#> Model =               unrestricted\n#> Kernel =              triangular\n#> BW method =           mannual\n#> VCE method =          jackknife\n#> \n#> c = 0                 Left of c           Right of c          \n#> Number of obs         1                   4999                \n#> Eff. Number of obs    1                   7                   \n#> Order est. (p)        2                   2                   \n#> Order bias (q)        3                   3                   \n#> BW est. (h)           2.5                 2.5                 \n#> \n#> Method                T                   P > |T|             \n#> Robust                NA                  NA\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in summary.CJMrddensity(half_bandwidth_result): Bandwidth hl greater\n#> than the range of the data.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in summary.CJMrddensity(half_bandwidth_result): Bandwidth h may be too\n#> small.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> P-values of binomial tests (H0: p=0.5).\n#> \n#> Window Length / 2          <c     >=c    P>|T|\n#> 3.519                       1      20    0.0000\n```\n:::\n\n```{.r .cell-code}\n#double the bandwidth\ndouble_bandwidth_result <- rddensity(data$purchase_after, h = bandwidth_original * 2)\nsummary(double_bandwidth_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Manipulation testing using local polynomial density estimation.\n#> \n#> Number of obs =       5000\n#> Model =               unrestricted\n#> Kernel =              triangular\n#> BW method =           mannual\n#> VCE method =          jackknife\n#> \n#> c = 0                 Left of c           Right of c          \n#> Number of obs         1                   4999                \n#> Eff. Number of obs    1                   1118                \n#> Order est. (p)        2                   2                   \n#> Order bias (q)        3                   3                   \n#> BW est. (h)           10                  10                  \n#> \n#> Method                T                   P > |T|             \n#> Robust                NA                  NA\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in summary.CJMrddensity(double_bandwidth_result): Bandwidth hl greater\n#> than the range of the data.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in summary.CJMrddensity(double_bandwidth_result): Bandwidth h may be\n#> too small.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> P-values of binomial tests (H0: p=0.5).\n#> \n#> Window Length / 2          <c     >=c    P>|T|\n#> 3.519                       1      20    0.0000\n#> 4.239                       1      38    0.0000\n#> 4.960                       1      66    0.0000\n#> 5.680                       1      99    0.0000\n#> 6.400                       1     176    0.0000\n#> 7.120                       1     261    0.0000\n#> 7.840                       1     419    0.0000\n#> 8.560                       1     603    0.0000\n#> 9.280                       1     836    0.0000\n#> 10.000                      1    1118    0.0000\n```\n:::\n:::\n\n::: {.cell hash='10_rdd_cache/html/unnamed-chunk-3_3d4073392120f080656767ddf493b539'}\n\n```{.r .cell-code}\n#2nd part\n# Load necessary libraries and data\nlibrary(ggplot2)\nlibrary(foreign)  \n\nshipping_data <- readRDS(\"C:/Users/Anjali/Downloads/Causal_Data_Science_Data (1)/Causal_Data_Science_Data/shipping.rds\")\n\n# Check the structure of your data\nstr(shipping_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> tibble [6,666 × 1] (S3: tbl_df/tbl/data.frame)\n#>  $ purchase_amount: num [1:6666] 13.11 37.12 11.26 9.45 53.24 ...\n```\n:::\n\n```{.r .cell-code}\n# Check the structure of your data\nstr(shipping_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> tibble [6,666 × 1] (S3: tbl_df/tbl/data.frame)\n#>  $ purchase_amount: num [1:6666] 13.11 37.12 11.26 9.45 53.24 ...\n```\n:::\n\n```{.r .cell-code}\n# Create a histogram of purchase amounts\nggplot(shipping_data, aes(x = purchase_amount)) +\n  geom_histogram(binwidth = 5, fill = \"blue\", color = \"black\", alpha = 0.7) +\n  labs(title = \"Distribution of Purchase Amounts\",\n       x = \"Purchase Amount\",\n       y = \"Frequency\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](10_rdd_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\nThe histogram above illustrates the distribution of purchase amounts from the dataset corresponding to a past campaign where free shipping was offered for purchases with a total amount exceeding 30€. To determine whether purchase_amount is a suitable running variable with a natural cut-off at 30€, we can observe the shape of the distribution.\nThe histogram shows a noticeable change in frequency around the 30€ mark, suggesting a potential threshold effect. Values to the left of 30€ represent purchases that did not qualify for free shipping, while those to the right indicate purchases that met the criteria for free shipping. This natural separation aligns with the campaign's conditions, making purchase_amount a plausible running variable for assessing the impact of the free shipping offer. In conclusion, based on the visual examination of the histogram, purchase_amount appears to be a promising running variable for studying the impact of the free shipping campaign, with a clear threshold effect at the 30€ mark.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}