---
title: "Regression Discontinuity"
---
```{r}
#1st part

data <- readRDS("C:/Users/Anjali/Downloads/Causal_Data_Science_Data (1)/Causal_Data_Science_Data/coupon.rds")

# Define cut-off
c0 <- 60

library(rddensity)
rddd <- rddensity(data$days_since_last, c = c0)
summary(rddd)

```
```{r}
# Specify your outcome variable (dependent variable)
outcome_var <- "purchase_after"

# Specify your running variable (the variable used for the RDD)
running_var <- "days_since_last"

# Specify the bandwidth
bandwidth_original <- 5  # Adjust this value based on your initial analysis

lm_bw <- lm(purchase_after ~ days_since_last, data)
summary(lm_bw)

rddd <- rddensity(data$purchase_after, h = bandwidth_original)

# Print the results
summary(rddd)

# half the bandwidth
half_bandwidth_result <- rddensity(data$purchase_after, h = bandwidth_original/2)
summary(half_bandwidth_result)

#double the bandwidth
double_bandwidth_result <- rddensity(data$purchase_after, h = bandwidth_original * 2)
summary(double_bandwidth_result)
```




```{r}
#2nd part
# Load necessary libraries and data
library(ggplot2)
library(foreign)  

shipping_data <- readRDS("C:/Users/Anjali/Downloads/Causal_Data_Science_Data (1)/Causal_Data_Science_Data/shipping.rds")

# Check the structure of your data
str(shipping_data)

# Check the structure of your data
str(shipping_data)

# Create a histogram of purchase amounts
ggplot(shipping_data, aes(x = purchase_amount)) +
  geom_histogram(binwidth = 5, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Purchase Amounts",
       x = "Purchase Amount",
       y = "Frequency") +
  theme_minimal()

```
The histogram above illustrates the distribution of purchase amounts from the dataset corresponding to a past campaign where free shipping was offered for purchases with a total amount exceeding 30€. To determine whether purchase_amount is a suitable running variable with a natural cut-off at 30€, we can observe the shape of the distribution.
The histogram shows a noticeable change in frequency around the 30€ mark, suggesting a potential threshold effect. Values to the left of 30€ represent purchases that did not qualify for free shipping, while those to the right indicate purchases that met the criteria for free shipping. This natural separation aligns with the campaign's conditions, making purchase_amount a plausible running variable for assessing the impact of the free shipping offer. In conclusion, based on the visual examination of the histogram, purchase_amount appears to be a promising running variable for studying the impact of the free shipping campaign, with a clear threshold effect at the 30€ mark.
